[{"/root/aloop-frontend/src/index.tsx":"1","/root/aloop-frontend/src/style/theme.ts":"2","/root/aloop-frontend/src/style/animations.tsx":"3","/root/aloop-frontend/src/components/app/App.tsx":"4","/root/aloop-frontend/src/style/colors.ts":"5","/root/aloop-frontend/src/style/fontFaces.ts":"6","/root/aloop-frontend/src/components/app/authReducer.ts":"7","/root/aloop-frontend/src/components/StartupChecks.tsx":"8","/root/aloop-frontend/src/components/app/SocketProvider.tsx":"9","/root/aloop-frontend/src/routes/Router.tsx":"10","/root/aloop-frontend/src/api/authQueries.ts":"11","/root/aloop-frontend/src/utils/sockets/socketTemp.tsx":"12","/root/aloop-frontend/src/pages/VideoPage.tsx":"13","/root/aloop-frontend/src/routes/Paths.ts":"14","/root/aloop-frontend/src/pages/Auth/ProfilePage.tsx":"15","/root/aloop-frontend/src/pages/Auth/LoginPage.tsx":"16","/root/aloop-frontend/src/pages/HomePage.tsx":"17","/root/aloop-frontend/src/pages/Auth/RegisterPage.tsx":"18","/root/aloop-frontend/src/api/defaults.ts":"19","/root/aloop-frontend/src/config.ts":"20","/root/aloop-frontend/src/api/messageQueries.ts":"21","/root/aloop-frontend/src/style/icons.ts":"22","/root/aloop-frontend/src/utils/MakeAction.tsx":"23","/root/aloop-frontend/src/components/video/ManageWindow.tsx":"24","/root/aloop-frontend/src/components/video/VideoMenu.tsx":"25","/root/aloop-frontend/src/components/chat/ChatWindow.tsx":"26","/root/aloop-frontend/src/pages/templates/CenteredPage.tsx":"27","/root/aloop-frontend/src/components/forms/Auth/LoginForm.tsx":"28","/root/aloop-frontend/src/components/forms/Auth/RegisterForm.tsx":"29","/root/aloop-frontend/src/api/videoQueries.ts":"30","/root/aloop-frontend/src/utils/validators/passwordValidation.ts":"31","/root/aloop-frontend/src/utils/validators/emailValidation.ts":"32","/root/aloop-frontend/src/components/forms/template/FormTemplate.tsx":"33","/root/aloop-frontend/src/utils/forms/MakeForm.tsx":"34","/root/aloop-frontend/src/utils/text/camelToSentence.ts":"35","/root/aloop-frontend/src/utils/text/stringAsNestedSelector.ts":"36","/root/aloop-frontend/src/components/video/VideoCall.tsx":"37","/root/aloop-frontend/src/components/video/VideoPanel.tsx":"38","/root/aloop-frontend/src/utils/useRefCallback.tsx":"39","/root/aloop-frontend/src/components/video/VideoWindow.tsx":"40"},{"size":749,"mtime":1621260867475,"results":"41","hashOfConfig":"42"},{"size":1704,"mtime":1621260867475,"results":"43","hashOfConfig":"42"},{"size":236,"mtime":1621260867475,"results":"44","hashOfConfig":"42"},{"size":1712,"mtime":1621260867475,"results":"45","hashOfConfig":"42"},{"size":14224,"mtime":1621260867475,"results":"46","hashOfConfig":"42"},{"size":532,"mtime":1621260867475,"results":"47","hashOfConfig":"42"},{"size":1361,"mtime":1621394654445,"results":"48","hashOfConfig":"42"},{"size":872,"mtime":1621260867475,"results":"49","hashOfConfig":"42"},{"size":1130,"mtime":1621260867475,"results":"50","hashOfConfig":"42"},{"size":1915,"mtime":1621260867475,"results":"51","hashOfConfig":"42"},{"size":1981,"mtime":1621260867475,"results":"52","hashOfConfig":"42"},{"size":13696,"mtime":1621387405852,"results":"53","hashOfConfig":"42"},{"size":8764,"mtime":1621398346573,"results":"54","hashOfConfig":"42"},{"size":282,"mtime":1621260867475,"results":"55","hashOfConfig":"42"},{"size":996,"mtime":1621260867475,"results":"56","hashOfConfig":"42"},{"size":550,"mtime":1621260867475,"results":"57","hashOfConfig":"42"},{"size":2757,"mtime":1621260867475,"results":"58","hashOfConfig":"42"},{"size":423,"mtime":1621260867475,"results":"59","hashOfConfig":"42"},{"size":425,"mtime":1621260867475,"results":"60","hashOfConfig":"42"},{"size":822,"mtime":1621260867475,"results":"61","hashOfConfig":"42"},{"size":4986,"mtime":1621260867475,"results":"62","hashOfConfig":"42"},{"size":2557,"mtime":1621396208609,"results":"63","hashOfConfig":"42"},{"size":1185,"mtime":1621260867475,"results":"64","hashOfConfig":"42"},{"size":3867,"mtime":1621396628132,"results":"65","hashOfConfig":"42"},{"size":1775,"mtime":1621397927538,"results":"66","hashOfConfig":"42"},{"size":4026,"mtime":1621260867475,"results":"67","hashOfConfig":"42"},{"size":821,"mtime":1621260867475,"results":"68","hashOfConfig":"42"},{"size":3037,"mtime":1621260867475,"results":"69","hashOfConfig":"42"},{"size":3049,"mtime":1621260867475,"results":"70","hashOfConfig":"42"},{"size":2168,"mtime":1621397254569,"results":"71","hashOfConfig":"42"},{"size":105,"mtime":1621260867475,"results":"72","hashOfConfig":"42"},{"size":123,"mtime":1621260867475,"results":"73","hashOfConfig":"42"},{"size":729,"mtime":1621260867475,"results":"74","hashOfConfig":"42"},{"size":1909,"mtime":1621260867475,"results":"75","hashOfConfig":"42"},{"size":363,"mtime":1621260867475,"results":"76","hashOfConfig":"42"},{"size":645,"mtime":1621260867475,"results":"77","hashOfConfig":"42"},{"size":9807,"mtime":1621397780020,"results":"78","hashOfConfig":"42"},{"size":921,"mtime":1621385783629,"results":"79","hashOfConfig":"42"},{"size":718,"mtime":1621260867475,"results":"80","hashOfConfig":"42"},{"size":3839,"mtime":1621397888810,"results":"81","hashOfConfig":"42"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"84","usedDeprecatedRules":"85"},"1a61slz",{"filePath":"86","messages":"87","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"88","messages":"89","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"90","messages":"91","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"92","usedDeprecatedRules":"85"},{"filePath":"93","messages":"94","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"95","messages":"96","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"101","usedDeprecatedRules":"85"},{"filePath":"102","messages":"103","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"104","usedDeprecatedRules":"85"},{"filePath":"105","messages":"106","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"107","usedDeprecatedRules":"85"},{"filePath":"108","messages":"109","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"110","messages":"111","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"112","usedDeprecatedRules":"85"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"115","messages":"116","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"117","usedDeprecatedRules":"85"},{"filePath":"118","messages":"119","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"120","usedDeprecatedRules":"85"},{"filePath":"121","messages":"122","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"125","usedDeprecatedRules":"85"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"128","messages":"129","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"130","messages":"131","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"136","messages":"137","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"138","usedDeprecatedRules":"85"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"141","usedDeprecatedRules":"85"},{"filePath":"142","messages":"143","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"144","messages":"145","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"146","usedDeprecatedRules":"85"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":1,"source":"149","usedDeprecatedRules":"85"},{"filePath":"150","messages":"151","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"152","messages":"153","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"154","messages":"155","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"156","usedDeprecatedRules":"85"},{"filePath":"157","messages":"158","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"159","messages":"160","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"161","messages":"162","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"163","usedDeprecatedRules":"85"},{"filePath":"164","messages":"165","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"166","usedDeprecatedRules":"85"},{"filePath":"167","messages":"168","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"169","messages":"170","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"171","messages":"172","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"173","messages":"174","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"175","messages":"176","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"177","messages":"178","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"/root/aloop-frontend/src/index.tsx",["179"],"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/app/App';\nimport reportWebVitals from './reportWebVitals';\nimport { gsaTheme } from './style/theme';\nimport { Provider } from '@fluentui/react-northstar';\nimport { bobbing } from './style/animations';\ngsaTheme.animations.bobbing = bobbing;\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider theme={gsaTheme}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n",["180","181"],"/root/aloop-frontend/src/style/theme.ts",[],"/root/aloop-frontend/src/style/animations.tsx",[],"/root/aloop-frontend/src/components/app/App.tsx",["182","183","184"],"import React, { createContext, useEffect, useReducer } from 'react';\nimport './App.css';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Button, Flex, Debug } from '@fluentui/react-northstar'\nimport { IconContext } from 'react-icons'\n// import { ws, client, room, makeConnection, localConnection } from '../../utils/sockets/socket';\nimport Router from '../../routes/Router'\nimport { QueryClient, QueryClientProvider } from 'react-query'\nimport { ReactQueryDevtools } from 'react-query/devtools'\nimport { authReducer, UserAuthContext } from './authReducer';\nimport { SocketProvider } from './SocketProvider'\nimport { useGetSelfQuery } from '../../api/authQueries';\nimport { StartupChecks } from '../StartupChecks';\n// The query client for react fetch\nexport const queryClient = new QueryClient()\n\n// The Context for global Auth state (Context API)\nexport const AuthUserContext = createContext<typeof undefined | UserAuthContext>(undefined);\n\nfunction App() {\n  const [selfState, dispatch] = useReducer(authReducer, {\n    auth: false,\n    user: null\n  })\n\n\n\n\n\n\n  return (\n    <AuthUserContext.Provider value={{ selfState, dispatch }}>\n      <SocketProvider>\n        <QueryClientProvider client={queryClient}>\n          <ReactQueryDevtools initialIsOpen={false} />\n          <StartupChecks>\n            <BrowserRouter>\n              <IconContext.Provider value={{ size: '1.25rem' }}>\n                <Flex column>\n                  <Router />\n                  <Debug />\n                </Flex>\n              </IconContext.Provider>\n            </BrowserRouter>\n          </StartupChecks>\n        </QueryClientProvider>\n      </SocketProvider>\n    </AuthUserContext.Provider>\n  );\n}\n\nexport default App;\n","/root/aloop-frontend/src/style/colors.ts",[],"/root/aloop-frontend/src/style/fontFaces.ts",[],"/root/aloop-frontend/src/components/app/authReducer.ts",[],"/root/aloop-frontend/src/components/StartupChecks.tsx",["185"],"import React, { useContext, useEffect } from 'react'\nimport { useGetSelfQuery } from '../api/authQueries';\nimport { AuthUserContext } from './app/App';\nimport { LOGIN } from './app/authReducer';\nimport { SocketContext } from './app/SocketProvider';\n\ninterface Props {\n\n}\n\nexport const StartupChecks: React.FC<Props> = ({ children }) => {\n    const authcontext = useContext(AuthUserContext)\n    const socketContext = useContext(SocketContext)\n    const { data, error } = useGetSelfQuery();\n\n    useEffect(() => {\n        if (data && !error && authcontext && socketContext.connectWebsocket) {\n            authcontext?.dispatch({\n                type: LOGIN,\n                payload: data,\n                connectWebsocket: socketContext.connectWebsocket\n            })\n        }\n    }, [data, error])\n\n    return (\n        <div>\n            {children}\n        </div>\n    )\n}","/root/aloop-frontend/src/components/app/SocketProvider.tsx",["186"],"import React, { createContext, useContext, useRef, useState } from 'react'\nimport { RTCSocket } from '../../utils/sockets/socketTemp';\nimport { Option } from '../../utils/types'\n\ninterface Props {\n\n}\n\ninterface SocketApiContext {\n    socket: Option<React.MutableRefObject<Option<RTCSocket>>>,\n    connectWebsocket: (user_id: number) => void\n    socketReady: boolean\n}\n\nexport const SocketContext = createContext<SocketApiContext>({ socket: undefined, connectWebsocket: () => { }, socketReady: false })\n\nexport const SocketProvider: React.FC<Props> = ({ children }) => {\n    const [socketReady, setSocketReady] = useState(false)\n    const socket = useRef<Option<RTCSocket>>(undefined);\n    const connectWebsocket = (user_id: number) => {\n        if ((!socket.current || socket.current?.ws.readyState === WebSocket.CLOSED)) {\n            // Connect\n            socket.current = new RTCSocket(user_id).setSocketHandlers();\n            setSocketReady(true)\n        }\n    }\n\n    return (\n        <SocketContext.Provider value={{ socket, connectWebsocket, socketReady }}>\n            {children}\n        </SocketContext.Provider>\n    )\n}","/root/aloop-frontend/src/routes/Router.tsx",["187","188","189","190","191","192"],"import React, { ReactElement } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\nimport RegisterPage from \"../pages/Auth/RegisterPage\";\nimport { LOGIN_PATH, REGISTER_PATH } from \"./Paths\";\nimport CenteredPage from \"../pages/templates/CenteredPage\";\nimport { VideoCall } from \"../components/video/VideoCall\";\nimport LoginPage from \"../pages/Auth/LoginPage\";\nimport { HomePage } from \"../pages/HomePage\";\nimport ProfilePage from \"../pages/Auth/ProfilePage\";\nimport { VideoRooms } from \"../components/video/VideoRooms\";\nimport { SidePanel } from '../components/video/SidePanel';\nimport { VideoPage } from \"../pages/VideoPage\";\n\n// eslint-disable-next-line import/no-anonymous-default-export\nexport default () => {\n  // const [{ data: loginData }] = useGetOwnEmailQuery();\n\n  // const onlyLoggedIn = (page: ReactElement, alt: ReactElement = <Redirect to=\"/login\" />) => loginData?.getSelf?.email ? page : alt\n  // const onlyLoggedOut = (page: ReactElement, alt: ReactElement = <Redirect to=\"/\" />) => !loginData?.getSelf?.email ? page : alt\n\n  // const self = useGetSelfQuery();\n\n  return (\n    <Switch>\n      <Route exact path=\"/\">\n        <HomePage />\n      </Route>\n      <Route path={LOGIN_PATH}>\n        {/* {onlyLoggedOut(<LoginPage />)} */}\n        <LoginPage />\n      </Route>\n      <Route path={REGISTER_PATH}>\n        <RegisterPage />\n      </Route>\n      <Route path={\"/video\"}>\n        <VideoPage />\n      </Route>\n      <Route path={\"/profile\"}>\n        <ProfilePage />\n      </Route>\n      {/* <Route path={PASS_RESET_PATH}>\n        {onlyLoggedOut(<ForgotPasswordPage />)}\n      </Route> */}\n      {/* <Route path={PASS_RESET_PATH + '/:token'}>\n        {onlyLoggedOut(<PasswordResetPage />)}\n      </Route> */}\n      <Route path=\"*\">\n        {/* <ErrorPage error={{ number: 404, message: \"Page not found\" }}></ErrorPage> */}\n      </Route>\n    </Switch>\n  )\n}","/root/aloop-frontend/src/api/authQueries.ts",[],"/root/aloop-frontend/src/utils/sockets/socketTemp.tsx",["193","194"],"import { MessageRes, TEXT_CHANNEL_MESSAGES_CACHE_KEY } from '../../api/messageQueries'\nimport { queryClient } from '../../components/app/App'\nimport { BASE_SOCKET_URL } from '../../config'\nimport { UnseenCounter } from '../../pages/VideoPage'\ntype ActionHandler = (json: any) => void\nconst HANDLE_CONNECTION_ACTION = 'HANDLE_COLLECTION'\nconst OFFER_ACTION = \"OFFER\"\nconst CANDIDATE_ACTION = \"CANDIDATE\"\nconst ANSWER_ACTION = \"ANSWER\"\ntype Actions = typeof CANDIDATE_ACTION | typeof OFFER_ACTION | typeof ANSWER_ACTION | typeof HANDLE_CONNECTION_ACTION\nconst MESSAGE_ACTION = \"NEW_MESSAGE\"\nconst iceConfig = {\n    iceServers: [{\n        urls: \"stun:stun.l.google.com:19302\"\n    },\n    {\n        urls: [\"stun:dropin.rossmacd.com:5349\"]\n    },\n    {\n        urls: \"turn:dropin.rossmacd.com:5349\",\n        username: \"sneakman\",\n        credential: \"sneakpass\"\n    }\n    ]\n}\ninterface OneToOneData {\n    protocol: '1:1',\n    data: any,\n    from: number,\n    to: number,\n    room: String,\n    action: Actions\n}\n\ninterface OneToAllData {\n    protocol: '1:A',\n    data: any,\n    from: number,\n    room: String,\n    action: Actions\n}\n\n\nexport class RTCSocket {\n    ws: WebSocket;\n    connections: Map<number, RTCPeerConnection>;\n    client_id: number;\n    actionHandlers: { [key: string]: ActionHandler }\n    updateTracks = (id: number) => { }\n    setCallMembers?: React.Dispatch<React.SetStateAction<number[]>>;\n    setUnseenCounter?: React.Dispatch<React.SetStateAction<UnseenCounter>>\n    handleDisconnect?: (id: number) => void\n\n    changeSetUnseetCounter = (counterFunc: React.Dispatch<React.SetStateAction<UnseenCounter>> | undefined) => {\n        this.setUnseenCounter = counterFunc\n    }\n    muteCam: () => boolean\n    muteMic: () => boolean\n\n\n    constructor(client_id: number) {\n        this.ws = new WebSocket(`${BASE_SOCKET_URL}/signalling/`);\n        // this.localConnection = new RTCPeerConnection();\n        this.connections = new Map<number, RTCPeerConnection>();\n        this.client_id = client_id\n        this.actionHandlers = {}\n        this.muteCam = () => false\n        this.muteMic = () => false\n    }\n\n    clearConnections = () => {\n\n    }\n\n\n    setSocketHandlers = () => {\n        // const ws = this.ws;\n        this.ws.onopen = (e) => {\n            console.log('Websocket Connection');\n        };\n        this.ws.onmessage = async (e) => {\n            const json = JSON.parse(e.data);\n            console.log(\"Handling\", (json.from !== this.client_id && (!json.to || json?.to === this.client_id)) || (!json.from && !json?.to))\n\n            if ((json.from !== this.client_id && (!json.to || json?.to === this.client_id)) || (!json.from && !json?.to)) {\n                switch (json.action) {\n                    case HANDLE_CONNECTION_ACTION:\n                        console.log('NEW PEER WANTS TO CONNECT');\n                        // This means that a new peer is attempting to connect\n                        // A peer must be set up\n                        await this.addPeer(json.from, json.room);\n                        break;\n                    case OFFER_ACTION:\n                        console.log('GOT OFFER FROM A NODE WE WANT TO CONNECT TO');\n                        console.log('THE NODE IS', json.from);\n                        await this.processOffer(json.from, json.room, json.data);\n                        break;\n                    case CANDIDATE_ACTION:\n                        console.log('NEW Candidate');\n                        const candidate_connection = this.connections.get(json.from);\n                        if (candidate_connection) {\n                            candidate_connection.addIceCandidate(new RTCIceCandidate(json.data));\n                            this.connections.set(json.from, candidate_connection)\n                        }\n                        break;\n                    case ANSWER_ACTION:\n                        console.log('--- GOT ANSWER IN CONNECT ---');\n                        const connection = this.connections.get(json.from);\n                        // console.log('HJAHSDHASHDHASDHASDHASDHASDASDHASDasdasdasd', json.from);\n                        if (connection) {\n                            connection.setRemoteDescription(new RTCSessionDescription(json.data));\n                            this.connections.set(json.from, connection)\n                        }\n                        break;\n                    case MESSAGE_ACTION:\n                        // Optimisticly update the frontend\n                        console.log(\"UPdating messages\", json.message.text_channel_id)\n                        queryClient.setQueryData<MessageRes[]>([TEXT_CHANNEL_MESSAGES_CACHE_KEY, json.message.text_channel_id], old => old ? [...old, json.message] : [])\n                        // Add to unseen notifications\n\n                        if (this.setUnseenCounter) {\n                            console.log(\"UPdating Counter\")\n                            this.setUnseenCounter((oldCounter) => {\n                                if (oldCounter[json.message.text_channel_id]) {\n                                    console.log(\"DOING IT Helll yesh\")\n                                    oldCounter[json.message.text_channel_id] = oldCounter[json.message.text_channel_id] + 1\n                                } else {\n                                    oldCounter[json.message.text_channel_id] = 1\n                                }\n                                return { ...oldCounter }\n                            })\n                        }\n\n                        console.log(\"Invalidatre\")\n                        // Invalidate data and refresh\n                        // DOing nothing????????????\n                        queryClient.invalidateQueries([TEXT_CHANNEL_MESSAGES_CACHE_KEY, json.message.text_channel_id])\n                        break\n                    case \"INVALIDATE\":\n                        queryClient.invalidateQueries(json.query_key)\n                        break\n                    case \"ROOM_JOIN\":\n                        // userJoinedRoom json.room, joson.user_id\n                        break\n                    default:\n                        for (const handler in this.actionHandlers) {\n                            console.log(\"Attempting handler\", handler)\n                            this.actionHandlers[handler](json)\n                        }\n                }\n\n                switch (json.protocol) {\n                    case 'GET_ONLINE_USERS':\n                        //DO SOMETHING\n                        //! onGetOnlineUsers(json);\n                        break;\n                }\n            };\n        }\n        return this;\n    };\n\n    makeConnection = (room: String, setCallMembers: React.Dispatch<React.SetStateAction<number[]>>, handleDisconnect: (id: number) => void): boolean => {\n        if (this.ws.readyState === WebSocket.OPEN) {\n            console.log('Connected -> sending negotiations',);\n            this.setCallMembers = setCallMembers\n            this.handleDisconnect = handleDisconnect\n            this.sendOneToAllNegotiation(HANDLE_CONNECTION_ACTION, room, this.client_id)\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n\n\n\n\n    addPeer = async (requester_id: number, room: String,) => {\n        console.log('CONNECTING PEERS');\n        // Create the local connection and its event listeners\n        let connection = new RTCPeerConnection(\n            iceConfig\n        );\n        connection.onicecandidate = (iceEvent) => {\n            // Send the ice candidate\n            if (iceEvent.candidate) {\n                this.sendOneToOneNegotiation(CANDIDATE_ACTION, room, requester_id, iceEvent.candidate);\n            }\n        };\n\n\n        this.connections.set(requester_id, connection);\n        this.updateTracks(requester_id)\n        this.setCallMembers ? this.setCallMembers(members => [...Array.from(new Set([...members, requester_id]))]) : console.error(\"Didnt set call mebers\")\n        connection = this.connections.get(requester_id) || new RTCPeerConnection(iceConfig);\n        connection.onconnectionstatechange = () => {\n            if (connection.iceConnectionState === 'disconnected' && this.handleDisconnect) {\n                this.handleDisconnect(requester_id)\n            }\n        }\n        // Send an offer to the peer\n        await connection.createOffer({ offerToReceiveVideo: true })\n            .then((offer) => {\n                connection.setLocalDescription(offer);\n                this.sendOneToOneNegotiation(OFFER_ACTION, room, requester_id, offer);\n                console.log('------ SEND OFFER ------');\n                this.connections.set(requester_id, connection);\n                // this.updateTracks()\n            })\n            .catch((err) => {\n                throw err;\n            });\n        // Add the peer to the conenctions map\n    };\n\n\n    processOffer = async (requester: number, room: String, remoteOffer: RTCSessionDescriptionInit) => {\n        console.log('RUNNING PROCESS OFFER', requester, this.connections);\n        // let localConnection = new RTCPeerConnection({});\n        const connection = this.connections.get(requester)\n        if (connection) {\n            connection.onicecandidate = (event) => {\n                if (event.candidate) {\n                    this.sendOneToOneNegotiation(CANDIDATE_ACTION, room, requester, event.candidate);\n                }\n            };\n\n            // SEND ANSWER\n            //   setCallerId(json.from);\n            connection.setRemoteDescription(new RTCSessionDescription(remoteOffer));\n            await connection.createAnswer().then((localDescription) => {\n                connection.setLocalDescription(localDescription);\n                console.log('------ SEND ANSWER ------');\n                this.sendOneToOneNegotiation(ANSWER_ACTION, room, requester, localDescription);\n                this.connections.set(requester, connection);\n            }).catch(err => console.error(err));\n        } else {\n            console.error(\"No connection>? Retrying\")\n\n            const newConnection = new RTCPeerConnection(iceConfig)\n            newConnection.onconnectionstatechange = () => {\n                if (newConnection.iceConnectionState === 'disconnected' && this.handleDisconnect) {\n                    this.handleDisconnect(requester)\n                }\n            }\n            this.connections.set(requester, newConnection)\n\n            this.updateTracks(requester)\n            this.setCallMembers ? this.setCallMembers(members => [...Array.from(new Set([...members, requester]))]) : console.error(\"Didnt set call mebers\")\n            this.processOffer(requester, room, remoteOffer)\n        }\n    }\n\n    // Send connection request to a specific endpoint-id\n    sendOneToAllNegotiation = (\n        action: Actions,\n        room: String,\n        // endpoint: any,\n        data: any,\n    ) => {\n        console.log('Action:', action, !!this.ws);\n        this.ws.send(\n            JSON.stringify({\n                protocol: '1:A',\n                from: this.client_id,\n                room: room,\n                // endpoint: endpoint,\n                action,\n                data: data,\n            })\n        );\n    };\n\n    // // Send connection request to a specific endpoint-id\n    sendOneToOneNegotiation = (\n        action: Actions,\n        room: String,\n        to: number,\n        data: any,\n    ) => {\n        console.log('Action:', action, !!this.ws);\n        this.ws.send(\n            JSON.stringify({\n                protocol: '1:1',\n                from: this.client_id,\n                room,\n                to,\n                action,\n                data: data,\n            })\n        );\n    };\n\n\n\n\n\n\n    setTracks = (gotRemoteStream: (e: any, id: number) => void, stream: MediaStream,) => {\n        const extendedGotRemoteStream = (id: number) => (e: any) => {\n            gotRemoteStream(e, id)\n        }\n\n        this.updateTracks = (id: number) => {\n            const connection = this.connections.get(id)\n            stream.getTracks().forEach(track => {\n                // Add the Add the track and add a listenr\n                if (connection) {\n                    connection.addTrack(track, stream);\n                    // Loop through all tracks and then set the stream handler\n                    connection.ontrack = extendedGotRemoteStream(id)\n                    this.connections.set(id, connection)\n                }\n            })\n        }\n\n        this.muteCam = () => {\n            stream.getVideoTracks()[0].enabled = !(stream.getVideoTracks()[0].enabled);\n            return stream.getVideoTracks()[0].enabled\n        }\n\n        this.muteMic = () => {\n            stream.getAudioTracks()[0].enabled = !(stream.getAudioTracks()[0].enabled);\n            return stream.getAudioTracks()[0].enabled\n        }\n    }\n\n    // muteCam = ()=>{\n\n    // }\n\n    emptyTracks = (/*requester: number*/) => {\n        // this.localConnection.ontrack = () => { }\n        // this.localConnection = new RTCPeerConnection()\n        // this.localConnection = new RTCPeerConnection()\n        // this.connections.delete(requester)\n        // this.connections = new Map()\n    }\n\n\n    joinVidChan = (room: String, action: (json: any) => void) => {\n        this.ws.send(JSON.stringify({\n            room,\n            from: this.client_id,\n            protocol: 'JOIN_VIDCHAN',\n        }))\n        this.actionHandlers[\"ROOM_JOIN\"] = (json) => {\n            console.log()\n            if (json.action === \"ROOM_JOIN\" && json.user_id === this.client_id) {\n                action(json)\n            }\n        }\n    }\n\n    clearHandler = (action: string) => {\n        delete this.actionHandlers[action]\n    }\n}","/root/aloop-frontend/src/pages/VideoPage.tsx",["195","196","197","198","199","200","201","202","203","204","205","206"],"/root/aloop-frontend/src/routes/Paths.ts",["207"],"export const LOGIN_PATH = '/login';\nexport const REGISTER_PATH = '/register';\nexport const PASS_RESET_PATH = '/register';\nexport const SELF_PATH = `/self`;\nexport const USER_PATH = '/user';\n\nexport const USERS_PATH = `${USER_PATH}s`;\n\n// Crud suffixes\nconst CREATE_SUFFIX = '/new';\n","/root/aloop-frontend/src/pages/Auth/ProfilePage.tsx",["208","209","210","211"],"import React, { ReactElement, useEffect } from 'react';\nimport CenteredPage from '../templates/CenteredPage';\nimport { Link, Redirect } from 'react-router-dom';\nimport { LOGIN_PATH, } from '../../routes/Paths';\nimport { useGetSelfQuery } from '../../api/authQueries';\nimport { Flex, Loader, Text } from '@fluentui/react-northstar'\n\nconst ProfilePage = (): ReactElement => {\n    // const authenticated = false\n\n    // const cache = useQueryCache();\n    const { status, data, error, isFetching } = useGetSelfQuery();\n\n    return isFetching ? (<Loader />) : !error ?\n        (\n            <CenteredPage>\n                <h1>Welcome {data.email}</h1>\n            </CenteredPage>\n        )\n        : (\n            // <Redirect to={LOGIN_PATH} />\n            <CenteredPage>\n                <Text error>{typeof error === \"string\" ? error : \"Authentication Error: Timeout\"}</Text>\n                <Link to={LOGIN_PATH}>Login</Link>\n            </CenteredPage>\n        )\n\n\n}\n\n\nexport default ProfilePage;\n","/root/aloop-frontend/src/pages/Auth/LoginPage.tsx",[],"/root/aloop-frontend/src/pages/HomePage.tsx",["212","213","214","215","216"],"import { Flex, Loader, Text, Button, Animation } from '@fluentui/react-northstar'\nimport React, { useContext } from 'react'\nimport { useQueryClient } from 'react-query'\nimport { Link } from 'react-router-dom'\nimport { useGetUsers } from '../api/authQueries'\nimport { AuthUserContext } from '../components/app/App'\nimport { LOGIN_PATH, REGISTER_PATH } from '../routes/Paths'\nimport CenteredPage from './templates/CenteredPage'\nimport { colors } from '../style/colors'\n// import svgBackground from '../../public/bubbles.svg'\ninterface Props {\n\n}\n\nexport const HomePage: React.FC<Props> = ({ children }) => {\n    // const cache = useQueryClient();\n    // const { data, error, isFetching } = useGetUsers();\n    const authcontext = useContext(AuthUserContext)\n    // { height: '100vh', overflowY: 'scroll', width: '100%', justifyContent: 'center', backgroundColor: gsaTheme.siteVariables.colors.grey[200] }\n\n    return (\n        <Animation name=\"bobbing\" direction=\"alternate\">\n            <Flex styles={{ height: '100vh', width: \"100vw\", justifyContent: \"center\", padding: '2rem 10rem', backgroundImage: `url(/bubbles.svg)`, backgroundColor: colors.grey[\"50\"] }} >\n                <Flex styles={{ flexDirection: \"column\", backgroundColor: colors.grey[\"0\"], padding: \"2rem 6rem\", width: '100%', textAlign: \"center\", alignContent: \"center\" }}>\n                    <h1 style={{ fontSize: \"10vw\", textAlign: \"center\" }}>Drop-In</h1>\n                    <h2>{authcontext?.selfState?.auth ? \"Welcome back, \" + authcontext?.selfState?.user?.first_name : \"Peer-To-Peer remote working\"}</h2>\n                    {!authcontext?.selfState?.auth ?\n                        <>\n                            <Button primary as={Link} to={LOGIN_PATH} style={{ marginBottom: \"0.5rem\" }}>Login</Button>\n                            <Button secondary as={Link} to={REGISTER_PATH}>Register</Button>\n                        </> :\n                        <>\n                            <Button primary as={Link} to='/video' style={{ marginBottom: \"0.5rem\" }}>Enter</Button>\n                            <Button secondary as={Link} to='/profile' >Profile</Button>\n\n                        </>}\n                </Flex>\n            </Flex >\n        </Animation>\n\n    )\n}\n\n\n// // <CenteredPage>\n// {/* {onlyLoggedIn(<Temp />, <h1>Welcome to Greenstar Aviation</h1>)} */ }\n\n// {/* <Text content=\"Users:\" size=\"largest\" weight=\"bold\" /> */ }\n// {/* {\n//                 isFetching ?\n//                     (<Loader />) :\n//                     (error ? (<Text content=\"Error retrieving users\" error />) : (\n//                         data.map((user: any) => (<Text content={user.first_name} key={user.user_id} />))\n//                     ))\n//             } */}\n\n\n//         // </CenteredPage>","/root/aloop-frontend/src/pages/Auth/RegisterPage.tsx",[],"/root/aloop-frontend/src/api/defaults.ts",[],"/root/aloop-frontend/src/config.ts",[],"/root/aloop-frontend/src/api/messageQueries.ts",[],"/root/aloop-frontend/src/style/icons.ts",[],"/root/aloop-frontend/src/utils/MakeAction.tsx",["217","218","219","220"],"import { Flex, Label, MenuButton, Button } from '@fluentui/react-northstar';\nimport React, { useState } from 'react'\nimport { VertMenuIcon } from '../style/icons';\nimport { colors } from '../style/colors'\n\n\nexport const makeAction = (Component: any, props: any) => {\n    const { action, ...restProps } = props;\n    return <Component {...restProps} onClick={action} />\n}\n\n\n\nexport const makeMenuAction = (Component: any, props: any) => {\n    // const { action, ...restProps } = props;\n    const { action, role_id, unseen, style, ...restProps } = props;\n    return (<Flex styles={{ alignItems: \"center\", justifyContent: \"space-between\", width: \"100%\" }} >\n        <   Component {...restProps} onClick={action} wrapper={{ style: { ...style, flex: \"1\" } }} />\n        {\n            unseen && unseen > 0 ? <Label\n                // styles={{ position: \"absolute\", right: \"0.1rem\" }}\n                content={unseen}\n                color={colors.green[\"300\"]}\n                circular\n            /> : \"\"\n        }\n        {/* {\n            role_id !== 2 ? <MenuButton trigger={<Button iconOnly text icon={<VertMenuIcon />} />}>\n\n            </MenuButton> : \"\"\n        } */}\n    </Flex >)\n}","/root/aloop-frontend/src/components/video/ManageWindow.tsx",["221","222","223","224","225","226"],"import { Flex, Input, Button, SendIcon, Text, List } from '@fluentui/react-northstar';\nimport React, { SyntheticEvent, useMemo } from 'react'\nimport { MessageIcon, CancelIcon, AddedUserIcon } from '../../style/icons';\nimport { gsaTheme } from '../../style/theme';\nimport { MessageChannelIcon, PlusIcon } from '../../style/icons'\nimport { useGetUsers, UserRes } from \"../../api/authQueries\"\nimport { useAddUserTextChannelQuery, useGetTextChannelUsersQuery } from \"../../api/messageQueries\"\nimport { colors } from '../../style/colors'\n\ninterface Props {\n    selectedTextChan: [number, String],\n    setSelectedTextChan: React.Dispatch<React.SetStateAction<[number, String] | undefined>>\n}\n\nexport const ManageWindow: React.FC<Props> = ({ children, selectedTextChan, setSelectedTextChan }) => {\n\n    const { data } = useGetUsers()\n    const { data: textUserData } = useGetTextChannelUsersQuery(selectedTextChan[0]);\n    const { mutate } = useAddUserTextChannelQuery()\n    // const unassignedUsers = useMemo(() => {\n    //     const outUsers = []\n\n    //     for(const text of data)\n\n    //     return outUsers\n    // }, [data, textUserData])\n\n    return (\n        <Flex style={{ width: '28rem', height: '100%', position: \"relative\", top: 0, left: 0, flexDirection: \"column\" }}>\n            <Flex style={{ width: \"100%\", padding: \"1rem 0 1rem 0\", backgroundColor: gsaTheme.siteVariables.colors.grey['50'], flexDirection: \"column\", height: \"100vh\", overflowY: \"scroll\" }} >\n                <Flex style={{ width: \"100%\", justifyContent: \"center\", alignItems: \"center\" }}>\n                    <MessageChannelIcon /><Text size=\"large\">{selectedTextChan[1]}</Text >\n                </Flex>\n                <Text>Added Users:</Text>\n                <List items={textUserData?.map((user: any) => ({\n                    key: \"added\" + user.user_id,\n                    // media: <Status state=\"error\" icon={<ErrorIcon />} />,\n                    icon: <AddedUserIcon />,\n                    header: \"🟢 \" + user.first_name + \" \" + user.last_name,\n                    content: user.email,\n                    // headerMedia: <Button iconOnly icon={<PlusIcon />} onClick={() => mutate({ chan_id: selectedTextChan[0], user: user })}></Button>,\n                }))} />\n\n                {/* {textUserData?.map((user: any) => (<Text styles={{ color: colors.green[\"400\"] }} key={`userKey:${user.user_id}`}>{user.email}</Text>))} */}\n                <Text>Other Users:</Text>\n                <List items={data?.filter((all_user: UserRes) => textUserData?.findIndex((added_user) => added_user.user_id === all_user.user_id) === -1).map((user: any) => ({\n                    key: \"added\" + user.user_id,\n                    // media: <Status state=\"error\" icon={<ErrorIcon />} />,\n                    // icon: <AddedUserIcon />,\n                    header: user.first_name + \" \" + user.last_name,\n                    content: user.email,\n                    endMedia: <Button styles={{ position: \"absolute\" }} iconOnly icon={<PlusIcon />} onClick={() => mutate({ chan_id: selectedTextChan[0], user: user })}></Button>,\n                }))} />\n\n\n                {/* {data?.filter((all_user: UserRes) => textUserData?.findIndex((added_user) => added_user.user_id === all_user.user_id) === -1).map((user: any) => (<Text key={`userKey:${user.user_id}`}>{user.email}<Button iconOnly icon={<PlusIcon />} onClick={() => mutate({ chan_id: selectedTextChan[0], user: user })}></Button></Text>))} */}\n            </Flex>\n            <Button onClick={() => { setSelectedTextChan(undefined) }} styles={{\n                alignSelf: 'flex-end', position: 'absolute', top: '1rem', right: '-1rem', ':hover': {\n                    backgroundColor: gsaTheme.siteVariables.colors.grey['800'],\n                },\n            }} icon={<CancelIcon />} iconOnly title=\"Close\" circular />\n        </Flex >\n    )\n}","/root/aloop-frontend/src/components/video/VideoMenu.tsx",["227","228"],"/root/aloop-frontend/src/components/chat/ChatWindow.tsx",["229","230","231","232","233","234"],"import React, { SyntheticEvent, useContext, useRef, useState, useMemo } from 'react'\nimport { Flex, Chat, Button, ChatItemProps, ShorthandCollection, Input } from \"@fluentui/react-northstar\"\nimport { CancelIcon, MessageIcon, SendIcon } from '../../style/icons'\nimport { gsaTheme } from '../../style/theme'\nimport { MessageRes, useGetTextChannelMessagesQuery, useNewMessageQuery } from '../../api/messageQueries'\nimport { AuthUserContext } from '../app/App'\nimport { useGetUsers } from '../../api/authQueries'\n\ninterface Props {\n    setSelectedTextChan: React.Dispatch<React.SetStateAction<[number, String] | undefined>>\n    selectedTextChan: [number, String]\n}\n\nexport const ChatWindow: React.FC<Props> = ({ children, setSelectedTextChan, selectedTextChan }) => {\n    const { data, error, isFetching } = useGetTextChannelMessagesQuery(selectedTextChan[0]);\n    const { data: usersData } = useGetUsers()\n    const usersMap = useMemo(() => {\n        const converted: { [id: number]: string } = {}\n        usersData?.forEach((user) => {\n            converted[user.user_id] = `${user.first_name} ${user.last_name}`;\n        })\n        return converted\n    }, [usersData])\n\n\n    const { mutate } = useNewMessageQuery();\n    const authContext = useContext(AuthUserContext)\n    // const messageInput = useRef<HTMLInputElement | null>(null)\n    const [text, setText] = useState<string>('')\n\n\n    const mapDataToItems = useMemo(() => {\n        console.log(data, usersMap, \"Hello\")\n        return data?.map((message) => ({\n            message: (\n                <Chat.Message content={message.contents}\n                    author={usersMap ? usersMap[message.author_id] : message.author_id}\n                    timestamp={new Date(Date.parse(message.created_at)).toLocaleString()}\n                    mine={message.author_id === authContext?.selfState.user?.user_id} />\n            ),\n            // contentPosition: message.author_id === authContext?.selfState.user?.user_id ? 'end' : 'start',\n            attached: 'top' as const,\n            key: 'message-id-' + message.message_id,\n        })) || []\n    }, [usersMap, data, authContext?.selfState.user?.user_id])\n\n    const sendMessage = () => {\n        if (text) {\n            mutate({\n                contents: text,\n                text_channel_id: selectedTextChan[0]\n            })\n            setText(\"\")\n        } else {\n            console.log(\"No value\")\n        }\n    }\n\n    return (\n        <Flex style={{ width: '24rem', height: '100%', position: \"relative\", top: 0, left: 0, flexDirection: \"column\" }}>\n            <Chat style={{ width: \"100%\", padding: 0, flex: 1, overflowY: 'scroll', flexDirection: 'column-reverse' }} items={mapDataToItems.reverse().slice(0, 10)} />\n            <Flex style={{ width: \"100%\", padding: \"1rem 0 1rem 0\", backgroundColor: gsaTheme.siteVariables.colors.grey['100'] }} >\n                <Input\n                    fluid\n                    placeholder={\"Message \" + selectedTextChan[1]}\n                    iconPosition=\"start\"\n                    icon={<MessageIcon />}\n                    value={text}\n                    onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                            sendMessage()\n                        }\n                    }}\n                    onChange={(e) => {\n                        const event = e as SyntheticEvent<HTMLInputElement, Event>;\n                        setText(event?.currentTarget?.value || \"\")\n                    }} />\n                <Button\n                    onClick={sendMessage}\n                    icon={<SendIcon />} iconOnly title=\"Send\" circular />\n            </Flex>\n            <Button onClick={() => { setSelectedTextChan(undefined) }} styles={{\n                alignSelf: 'flex-end', position: 'absolute', top: '1rem', right: '-1rem', ':hover': {\n                    backgroundColor: gsaTheme.siteVariables.colors.grey['800'],\n                },\n            }} icon={<CancelIcon />} iconOnly title=\"Close\" circular />\n        </Flex>\n    )\n}","/root/aloop-frontend/src/pages/templates/CenteredPage.tsx",["235","236","237"],"import React, { ReactElement } from 'react';\nimport { Button, Flex } from '@fluentui/react-northstar';\nimport { gsaTheme } from '../../style/theme';\n\ninterface Props {\n    vertCenter?: boolean\n}\n\nconst CenteredPage: React.FC<Props> = ({ children, vertCenter: vertCenter = false }) => (\n    <Flex styles={{ height: '100vh', overflowY: 'scroll', width: '100%', justifyContent: 'center', backgroundColor: gsaTheme.siteVariables.colors.grey[200] }}>\n        <Flex styles={{ minHeight: '80vh', height: 'fit-content', justifyContent: vertCenter ? 'center' : 'flex-start', alignItems: 'center', flexDirection: 'column', margin: '10vh 2rem', padding: '2rem', backgroundColor: gsaTheme.siteVariables.colors.white, width: 'min( 50rem, 100%)' }}>\n            {children}\n        </Flex>\n    </Flex>\n);\n\n\nexport default CenteredPage;\n","/root/aloop-frontend/src/components/forms/Auth/LoginForm.tsx",[],"/root/aloop-frontend/src/components/forms/Auth/RegisterForm.tsx",[],"/root/aloop-frontend/src/api/videoQueries.ts",["238"],"import { useMutation, useQuery } from 'react-query';\nimport { UserRes } from './authQueries';\nimport { getFetch, postFetch } from './defaults';\nimport { queryClient } from '../components/app/App';\n\nexport const VIDEO_CHANNEL_CACHE_KEY = 'video_channel';\n\nexport interface VideoChannelRes {\n  video_channel_id: number;\n  channel_name: string;\n  created_at: string;\n}\n\nconst getVideoChannels = async () =>\n  getFetch('/vidchan')\n    .then((res) => {\n      console.log(res);\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error('Authentication Error');\n      }\n    })\n    .catch((e) => {\n      console.error('POST REQUEST ERROR', e);\n      throw e;\n    });\n\nexport const useGetVideoChannelQuery = () =>\n  useQuery<VideoChannelRes[]>(VIDEO_CHANNEL_CACHE_KEY, getVideoChannels);\n\nconst getVideoChannelUsers = async (chan_id: number) =>\n  getFetch(`/vidchan/${chan_id}`)\n    .then((res) => {\n      console.log(res);\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error('Authentication Error');;\n      }\n    })\n    .catch((e) => {\n      console.error('POST REQUEST ERROR', e);\n      throw e;\n    });\nexport const useGetVideoChannelUsersQuery = (chan_id: number) =>\n  useQuery<UserRes[]>([VIDEO_CHANNEL_CACHE_KEY + \":users\", chan_id], () => getVideoChannelUsers(chan_id));\n\n\n\n\n\n\nconst addUserVideoChannel = async ({ chan_id, user }: { chan_id: number, user: UserRes }): Promise<[number, UserRes]> =>\n  getFetch(`/textchan/add/${chan_id}/${user.user_id}`)\n    .then((res) => {\n      console.log(res);\n      if (res.ok) {\n        const returnVal: [number, UserRes] = [chan_id, user]\n        return returnVal;\n      } else {\n        throw new Error('Authentication Error');\n      }\n    })\n    .catch((e) => {\n      console.error('POST REQUEST ERROR', e);\n      throw e;\n    });\n\nexport const useAddUserVideoChannelQuery = () => useMutation<[number, UserRes], Error, { chan_id: number, user: UserRes }, any>(\n  addUserVideoChannel, {\n  onSuccess: (data) => {\n    queryClient.setQueryData<UserRes[]>([VIDEO_CHANNEL_CACHE_KEY + \":users\", data[0]], (oldUsers) => oldUsers ? [...oldUsers, data[1]] : [data[1]])\n  },\n})","/root/aloop-frontend/src/utils/validators/passwordValidation.ts",[],"/root/aloop-frontend/src/utils/validators/emailValidation.ts",[],"/root/aloop-frontend/src/components/forms/template/FormTemplate.tsx",["239","240"],"import React, { ReactElement, useState } from 'react'\nimport { ComponentEventHandler, Form, FormButton, FormProps } from '@fluentui/react-northstar'\nimport { Redirect } from 'react-router-dom';\n\ninterface Props {\n    onSubmit?: ComponentEventHandler<FormProps>\n    success?: boolean,\n    fetching?: boolean\n    to?: string\n}\n\nexport const FormTemplate: React.FC<Props> = ({ children, onSubmit, success, fetching, to = '/' }) => {\n    return success ? <Redirect to={to} /> : (\n        <Form onSubmit={onSubmit} styles={{ justifyContent: 'start', width: 'auto', margin: '1rem 2rem' }}>\n            {children}\n            <FormButton content=\"Submit\" loading={fetching} disabled={fetching} fluid primary />\n        </Form>\n    )\n}\n\n","/root/aloop-frontend/src/utils/forms/MakeForm.tsx",["241"],"import React, { RefObject } from 'react'\nimport { Form, FormInput } from \"@fluentui/react-northstar\"\nimport { DeepMap } from 'react-hook-form/dist/types/utils'\nimport { FieldError } from 'react-hook-form'\nimport { FormStateProxy } from 'react-hook-form/dist/types/form'\nimport { stringAsNestedSelector } from '../text/stringAsNestedSelector'\nimport { camel2Sentence } from '../text/camelToSentence'\n\n\n\n\nexport interface ShorthandField {\n    id: string,\n    label?: string,\n    type?: string,\n    validation?: Rules,\n}\n\n\nexport interface Rules {\n    required?: string | boolean\n    maxLength?: number,\n    minLength?: number,\n    pattern?: RegExp,\n    validate?: (value: string) => boolean | string\n}\n\n\n\n// Turn an array into a validated form - the form generated will be validated with react hook forms\nexport const MakeForm = (fields: ShorthandField[], errors: DeepMap<Record<string, any>, FieldError>, register: (rules: Rules) => ((instance: HTMLInputElement | null) => void) | RefObject<HTMLInputElement> | null | undefined, formState: FormStateProxy<Record<string, any>>) => {\n    const form = []\n    for (const field of fields) {\n        const humanLabel = field.label || camel2Sentence(field.id)\n        // PERFORMANCE??? - this only needs to be done for dynamic forms, good place to look at performance if slow\n        const error = stringAsNestedSelector<typeof errors>(errors, field.id);\n        const touched = stringAsNestedSelector<typeof formState.touched>(formState.touched, field.id);\n        form.push(<FormInput\n            label={humanLabel}\n            id={field.id}\n            key={field.id}\n            name={field.id}\n            type={field?.type}\n            ref={register(field?.validation || {})}\n            errorMessage={error && (error.message || \"Please input a valid \" + humanLabel)}\n            showSuccessIndicator={!error && touched\n            } />)\n    }\n    return form\n}","/root/aloop-frontend/src/utils/text/camelToSentence.ts",[],"/root/aloop-frontend/src/utils/text/stringAsNestedSelector.ts",[],"/root/aloop-frontend/src/components/video/VideoCall.tsx",["242","243","244","245","246","247","248","249","250"],"/root/aloop-frontend/src/components/video/VideoPanel.tsx",[],"/root/aloop-frontend/src/utils/useRefCallback.tsx",[],"/root/aloop-frontend/src/components/video/VideoWindow.tsx",["251","252","253","254","255","256"],{"ruleId":"257","severity":1,"message":"258","line":5,"column":8,"nodeType":"259","messageId":"260","endLine":5,"endColumn":23},{"ruleId":"261","replacedBy":"262"},{"ruleId":"263","replacedBy":"264"},{"ruleId":"257","severity":1,"message":"265","line":1,"column":32,"nodeType":"259","messageId":"260","endLine":1,"endColumn":41},{"ruleId":"257","severity":1,"message":"266","line":4,"column":10,"nodeType":"259","messageId":"260","endLine":4,"endColumn":16},{"ruleId":"257","severity":1,"message":"267","line":12,"column":10,"nodeType":"259","messageId":"260","endLine":12,"endColumn":25},{"ruleId":"268","severity":1,"message":"269","line":24,"column":8,"nodeType":"270","endLine":24,"endColumn":21,"suggestions":"271"},{"ruleId":"257","severity":1,"message":"272","line":1,"column":32,"nodeType":"259","messageId":"260","endLine":1,"endColumn":42},{"ruleId":"257","severity":1,"message":"273","line":1,"column":17,"nodeType":"259","messageId":"260","endLine":1,"endColumn":29},{"ruleId":"257","severity":1,"message":"274","line":3,"column":20,"nodeType":"259","messageId":"260","endLine":3,"endColumn":26},{"ruleId":"257","severity":1,"message":"275","line":9,"column":8,"nodeType":"259","messageId":"260","endLine":9,"endColumn":20},{"ruleId":"257","severity":1,"message":"276","line":10,"column":10,"nodeType":"259","messageId":"260","endLine":10,"endColumn":19},{"ruleId":"257","severity":1,"message":"277","line":14,"column":10,"nodeType":"259","messageId":"260","endLine":14,"endColumn":20},{"ruleId":"257","severity":1,"message":"278","line":15,"column":10,"nodeType":"259","messageId":"260","endLine":15,"endColumn":19},{"ruleId":"257","severity":1,"message":"279","line":26,"column":11,"nodeType":"259","messageId":"260","endLine":26,"endColumn":23},{"ruleId":"257","severity":1,"message":"280","line":35,"column":11,"nodeType":"259","messageId":"260","endLine":35,"endColumn":23},{"ruleId":"257","severity":1,"message":"281","line":1,"column":10,"nodeType":"259","messageId":"260","endLine":1,"endColumn":20},{"ruleId":"257","severity":1,"message":"282","line":1,"column":98,"nodeType":"259","messageId":"260","endLine":1,"endColumn":102},{"ruleId":"257","severity":1,"message":"283","line":1,"column":110,"nodeType":"259","messageId":"260","endLine":1,"endColumn":115},{"ruleId":"257","severity":1,"message":"284","line":3,"column":10,"nodeType":"259","messageId":"260","endLine":3,"endColumn":33},{"ruleId":"257","severity":1,"message":"285","line":6,"column":10,"nodeType":"259","messageId":"260","endLine":6,"endColumn":20},{"ruleId":"257","severity":1,"message":"286","line":6,"column":42,"nodeType":"259","messageId":"260","endLine":6,"endColumn":54},{"ruleId":"257","severity":1,"message":"287","line":6,"column":56,"nodeType":"259","messageId":"260","endLine":6,"endColumn":72},{"ruleId":"257","severity":1,"message":"288","line":8,"column":10,"nodeType":"259","messageId":"260","endLine":8,"endColumn":20},{"ruleId":"257","severity":1,"message":"275","line":9,"column":8,"nodeType":"259","messageId":"260","endLine":9,"endColumn":20},{"ruleId":"257","severity":1,"message":"289","line":26,"column":40,"nodeType":"259","messageId":"260","endLine":26,"endColumn":53},{"ruleId":"257","severity":1,"message":"290","line":26,"column":67,"nodeType":"259","messageId":"260","endLine":26,"endColumn":85},{"ruleId":"268","severity":1,"message":"291","line":99,"column":8,"nodeType":"270","endLine":99,"endColumn":75,"suggestions":"292"},{"ruleId":"257","severity":1,"message":"293","line":10,"column":7,"nodeType":"259","messageId":"260","endLine":10,"endColumn":20},{"ruleId":"257","severity":1,"message":"265","line":1,"column":31,"nodeType":"259","messageId":"260","endLine":1,"endColumn":40},{"ruleId":"257","severity":1,"message":"294","line":3,"column":16,"nodeType":"259","messageId":"260","endLine":3,"endColumn":24},{"ruleId":"257","severity":1,"message":"295","line":6,"column":10,"nodeType":"259","messageId":"260","endLine":6,"endColumn":14},{"ruleId":"257","severity":1,"message":"296","line":12,"column":13,"nodeType":"259","messageId":"260","endLine":12,"endColumn":19},{"ruleId":"257","severity":1,"message":"297","line":1,"column":16,"nodeType":"259","messageId":"260","endLine":1,"endColumn":22},{"ruleId":"257","severity":1,"message":"298","line":1,"column":24,"nodeType":"259","messageId":"260","endLine":1,"endColumn":28},{"ruleId":"257","severity":1,"message":"299","line":3,"column":10,"nodeType":"259","messageId":"260","endLine":3,"endColumn":24},{"ruleId":"257","severity":1,"message":"300","line":5,"column":10,"nodeType":"259","messageId":"260","endLine":5,"endColumn":21},{"ruleId":"257","severity":1,"message":"275","line":8,"column":8,"nodeType":"259","messageId":"260","endLine":8,"endColumn":20},{"ruleId":"257","severity":1,"message":"281","line":1,"column":23,"nodeType":"259","messageId":"260","endLine":1,"endColumn":33},{"ruleId":"257","severity":1,"message":"266","line":1,"column":35,"nodeType":"259","messageId":"260","endLine":1,"endColumn":41},{"ruleId":"257","severity":1,"message":"301","line":2,"column":17,"nodeType":"259","messageId":"260","endLine":2,"endColumn":25},{"ruleId":"257","severity":1,"message":"286","line":3,"column":10,"nodeType":"259","messageId":"260","endLine":3,"endColumn":22},{"ruleId":"257","severity":1,"message":"302","line":1,"column":16,"nodeType":"259","messageId":"260","endLine":1,"endColumn":21},{"ruleId":"257","severity":1,"message":"303","line":1,"column":31,"nodeType":"259","messageId":"260","endLine":1,"endColumn":39},{"ruleId":"257","severity":1,"message":"304","line":2,"column":17,"nodeType":"259","messageId":"260","endLine":2,"endColumn":31},{"ruleId":"257","severity":1,"message":"305","line":2,"column":33,"nodeType":"259","messageId":"260","endLine":2,"endColumn":40},{"ruleId":"257","severity":1,"message":"306","line":3,"column":10,"nodeType":"259","messageId":"260","endLine":3,"endColumn":21},{"ruleId":"257","severity":1,"message":"307","line":8,"column":10,"nodeType":"259","messageId":"260","endLine":8,"endColumn":16},{"ruleId":"257","severity":1,"message":"308","line":13,"column":19,"nodeType":"259","messageId":"260","endLine":13,"endColumn":24},{"ruleId":"257","severity":1,"message":"309","line":13,"column":26,"nodeType":"259","messageId":"260","endLine":13,"endColumn":36},{"ruleId":"257","severity":1,"message":"310","line":1,"column":45,"nodeType":"259","messageId":"260","endLine":1,"endColumn":51},{"ruleId":"257","severity":1,"message":"311","line":2,"column":30,"nodeType":"259","messageId":"260","endLine":2,"endColumn":43},{"ruleId":"257","severity":1,"message":"312","line":2,"column":45,"nodeType":"259","messageId":"260","endLine":2,"endColumn":64},{"ruleId":"257","severity":1,"message":"313","line":5,"column":10,"nodeType":"259","messageId":"260","endLine":5,"endColumn":20},{"ruleId":"257","severity":1,"message":"308","line":15,"column":19,"nodeType":"259","messageId":"260","endLine":15,"endColumn":24},{"ruleId":"257","severity":1,"message":"309","line":15,"column":26,"nodeType":"259","messageId":"260","endLine":15,"endColumn":36},{"ruleId":"257","severity":1,"message":"273","line":1,"column":17,"nodeType":"259","messageId":"260","endLine":1,"endColumn":29},{"ruleId":"257","severity":1,"message":"266","line":2,"column":10,"nodeType":"259","messageId":"260","endLine":2,"endColumn":16},{"ruleId":"314","severity":1,"message":"315","line":9,"column":52,"nodeType":"316","messageId":"317","endLine":9,"endColumn":82,"fix":"318"},{"ruleId":"257","severity":1,"message":"319","line":3,"column":20,"nodeType":"259","messageId":"260","endLine":3,"endColumn":29},{"ruleId":"257","severity":1,"message":"273","line":1,"column":17,"nodeType":"259","messageId":"260","endLine":1,"endColumn":29},{"ruleId":"257","severity":1,"message":"301","line":1,"column":31,"nodeType":"259","messageId":"260","endLine":1,"endColumn":39},{"ruleId":"257","severity":1,"message":"320","line":2,"column":10,"nodeType":"259","messageId":"260","endLine":2,"endColumn":14},{"ruleId":"257","severity":1,"message":"321","line":1,"column":18,"nodeType":"259","messageId":"260","endLine":1,"endColumn":22},{"ruleId":"257","severity":1,"message":"322","line":2,"column":58,"nodeType":"259","messageId":"260","endLine":2,"endColumn":67},{"ruleId":"257","severity":1,"message":"323","line":44,"column":12,"nodeType":"259","messageId":"260","endLine":44,"endColumn":18},{"ruleId":"257","severity":1,"message":"324","line":75,"column":19,"nodeType":"259","messageId":"260","endLine":75,"endColumn":25},{"ruleId":"268","severity":1,"message":"325","line":90,"column":8,"nodeType":"270","endLine":90,"endColumn":36,"suggestions":"326"},{"ruleId":"257","severity":1,"message":"327","line":116,"column":11,"nodeType":"259","messageId":"260","endLine":116,"endColumn":18},{"ruleId":"268","severity":1,"message":"328","line":140,"column":8,"nodeType":"270","endLine":140,"endColumn":26,"suggestions":"329"},{"ruleId":"257","severity":1,"message":"330","line":142,"column":11,"nodeType":"259","messageId":"260","endLine":142,"endColumn":18},{"ruleId":"268","severity":1,"message":"331","line":200,"column":8,"nodeType":"270","endLine":200,"endColumn":22,"suggestions":"332"},{"ruleId":"257","severity":1,"message":"302","line":1,"column":16,"nodeType":"259","messageId":"260","endLine":1,"endColumn":21},{"ruleId":"257","severity":1,"message":"303","line":1,"column":31,"nodeType":"259","messageId":"260","endLine":1,"endColumn":39},{"ruleId":"257","severity":1,"message":"304","line":2,"column":17,"nodeType":"259","messageId":"260","endLine":2,"endColumn":31},{"ruleId":"257","severity":1,"message":"305","line":2,"column":33,"nodeType":"259","messageId":"260","endLine":2,"endColumn":40},{"ruleId":"257","severity":1,"message":"333","line":5,"column":10,"nodeType":"259","messageId":"260","endLine":5,"endColumn":28},{"ruleId":"257","severity":1,"message":"307","line":8,"column":10,"nodeType":"259","messageId":"260","endLine":8,"endColumn":16},"@typescript-eslint/no-unused-vars","'reportWebVitals' is defined but never used.","Identifier","unusedVar","no-native-reassign",["334"],"no-negated-in-lhs",["335"],"'useEffect' is defined but never used.","'Button' is defined but never used.","'useGetSelfQuery' is defined but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'authcontext' and 'socketContext.connectWebsocket'. Either include them or remove the dependency array.","ArrayExpression",["336"],"'useContext' is defined but never used.","'ReactElement' is defined but never used.","'Router' is defined but never used.","'CenteredPage' is defined but never used.","'VideoCall' is defined but never used.","'VideoRooms' is defined but never used.","'SidePanel' is defined but never used.","'OneToOneData' is defined but never used.","'OneToAllData' is defined but never used.","'MenuButton' is defined but never used.","'Chat' is defined but never used.","'Label' is defined but never used.","'useGetVideoChannelQuery' is defined but never used.","'CancelIcon' is defined but never used.","'VertMenuIcon' is defined but never used.","'VideoChannelIcon' is defined but never used.","'makeAction' is defined but never used.","'textChanError' is assigned a value but never used.","'textChanIsFetching' is assigned a value but never used.","React Hook useMemo has an unnecessary dependency: 'socketContext.socketReady'. Either exclude it or remove the dependency array.",["337"],"'CREATE_SUFFIX' is assigned a value but never used.","'Redirect' is defined but never used.","'Flex' is defined but never used.","'status' is assigned a value but never used.","'Loader' is defined but never used.","'Text' is defined but never used.","'useQueryClient' is defined but never used.","'useGetUsers' is defined but never used.","'useState' is defined but never used.","'Input' is defined but never used.","'SendIcon' is defined but never used.","'SyntheticEvent' is defined but never used.","'useMemo' is defined but never used.","'MessageIcon' is defined but never used.","'colors' is defined but never used.","'error' is assigned a value but never used.","'isFetching' is assigned a value but never used.","'useRef' is defined but never used.","'ChatItemProps' is defined but never used.","'ShorthandCollection' is defined but never used.","'MessageRes' is defined but never used.","no-useless-rename","Destructuring assignment vertCenter unnecessarily renamed.","Property","unnecessarilyRenamed",{"range":"338","text":"339"},"'postFetch' is defined but never used.","'Form' is defined but never used.","'Grid' is defined but never used.","'RefObject' is defined but never used.","'inCall' is assigned a value but never used.","'square' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'updateSizes'. Either include it or remove the dependency array.",["340"],"'pipeErr' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'gotRemoteStream' and 'socketContext?.socket'. Either include them or remove the dependency array. Mutable values like 'videoRef.current' aren't valid dependencies because mutating them doesn't re-render the component.",["341"],"'canPlay' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'disconnectCall' and 'joinRoom'. Either include them or remove the dependency array.",["342"],"'MessageChannelIcon' is defined but never used.","no-global-assign","no-unsafe-negation",{"desc":"343","fix":"344"},{"desc":"345","fix":"346"},[247,277],"vertCenter = false",{"desc":"347","fix":"348"},{"desc":"349","fix":"350"},{"desc":"351","fix":"352"},"Update the dependencies array to be: [authcontext, data, error, socketContext.connectWebsocket]",{"range":"353","text":"354"},"Update the dependencies array to be: [socketContext?.socket, setSelectedRoom]",{"range":"355","text":"356"},"Update the dependencies array to be: [callMembers, height, updateSizes, width]",{"range":"357","text":"358"},"Update the dependencies array to be: [gotRemoteStream, socketContext?.socket]",{"range":"359","text":"360"},"Update the dependencies array to be: [disconnectCall, joinRoom, selectedRoom]",{"range":"361","text":"362"},[784,797],"[authcontext, data, error, socketContext.connectWebsocket]",[3581,3648],"[socketContext?.socket, setSelectedRoom]",[3355,3383],"[callMembers, height, updateSizes, width]",[5351,5369],"[gotRemoteStream, socketContext?.socket]",[7645,7659],"[disconnectCall, joinRoom, selectedRoom]"]